import{g as Z,c as j,a as tt,b as et,d as st,o as nt,s as it,f as rt}from"./floating-ui.dom.CK5WTiSh.js";const ot={target:"body",api:"clearbit",queryDelay:500,placeholder:"请输入企业名称或统一社会信用代码",clearable:!0,backFill:!1,popupAppendToBody:!0,clearIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59L15.59 7L17 8.41L13.41 12L17 15.59z"/></svg>',autoFocus:!0,history:{enabled:!0,type:"localStorage",key:"company-history",showClear:!0,itemIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m15.1 19.37l1 1.74c-.96.44-2.01.73-3.1.84v-2.02c.74-.09 1.44-.28 2.1-.56zM4.07 13H2.05c.11 1.1.4 2.14.84 3.1l1.74-1c-.28-.66-.47-1.36-.56-2.1zM15.1 4.63l1-1.74c-.96-.44-2-.73-3.1-.84v2.02c.74.09 1.44.28 2.1.56zM19.93 11h2.02c-.11-1.1-.4-2.14-.84-3.1l-1.74 1c.28.66.47 1.36.56 2.1zM8.9 19.37l-1 1.74c.96.44 2.01.73 3.1.84v-2.02c-.74-.09-1.44-.28-2.1-.56zM11 4.07V2.05c-1.1.11-2.14.4-3.1.84l1 1.74c.66-.28 1.36-.47 2.1-.56zm7.36 3.1l1.74-1.01c-.63-.87-1.4-1.64-2.27-2.27l-1.01 1.74c.59.45 1.1.96 1.54 1.54zM4.63 8.9l-1.74-1c-.44.96-.73 2-.84 3.1h2.02c.09-.74.28-1.44.56-2.1zm15.3 4.1c-.09.74-.28 1.44-.56 2.1l1.74 1c.44-.96.73-2.01.84-3.1h-2.02zm-3.1 5.36l1.01 1.74c.87-.63 1.64-1.4 2.27-2.27l-1.74-1.01c-.45.59-.96 1.1-1.54 1.54zM7.17 5.64l-1-1.75c-.88.64-1.64 1.4-2.27 2.28l1.74 1.01a7.7 7.7 0 0 1 1.53-1.54zM5.64 16.83l-1.74 1c.63.87 1.4 1.64 2.27 2.27l1.01-1.74a7.7 7.7 0 0 1-1.54-1.53zM13 7h-2v5.41l4.29 4.29l1.41-1.41l-3.7-3.7V7z"/></svg>',clearIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M15 2h-3.5l-1-1h-5l-1 1H1v2h14zm1 7c-.7 0-1.37.1-2 .29V5H2v12c0 1.1.9 2 2 2h5.68A6.999 6.999 0 0 0 23 16c0-3.87-3.13-7-7-7zm-7 7c0 .34.03.67.08 1H4V7h8v3.26c-1.81 1.27-3 3.36-3 5.74zm7 5c-2.76 0-5-2.24-5-5s2.24-5 5-5s5 2.24 5 5s-2.24 5-5 5z"/><path fill="currentColor" d="M16.5 12H15v5l3.6 2.1l.8-1.2l-2.9-1.7z"/></svg>'},onFetch:()=>{},onSelect:()=>{},onClear:()=>{},onFocus:()=>{},onBlur:()=>{},onDropdownVisibleChange:()=>{},showSubmitButton:!0,submitButtonLabel:"Submit",offsetTop:5,autoFlip:!1,submitCallback:()=>{}},at=a=>typeof a=="string",U=a=>typeof a=="function",P=async(a,o)=>{for(const u of o)try{const l=ct(u,"{id}",a),m=await fetch(l);if(m.status===200){const v=await m.blob();return URL.createObjectURL(v)}}catch(l){console.error(l)}return""},ct=(a,o,u)=>a.replace(new RegExp(o,"g"),u),V=(a,o,u)=>{a.forEach(l=>{l.classList.remove(u)}),a[o].classList.add(u)},N=a=>a.replace(/(<([^>]+)>)/gi,""),lt=a=>{try{const o=JSON.parse(a);return Array.isArray(o)?o:[]}catch{return[]}},ut=(a,o="")=>o+Object.keys(a).map(u=>`${u}=${a[u]}`).join("&"),ht=(a,o)=>{const u=[];for(let l=0;l<a.length;l+=o)u.push(a.slice(l,l+o));return u},pt=(a,o)=>{if(!o.enabled||!o.key)return;const u=o.type==="localStorage"?localStorage:sessionStorage,l=J(o),m=l.findIndex(v=>v.id===a.id);m>-1&&l.splice(m,1),l.splice(0,0,a),u.setItem(o.key,JSON.stringify(l.length>5?l.slice(0,5):l))},J=a=>{if(!a.enabled||!a.key)return[];const u=(a.type==="localStorage"?localStorage:sessionStorage).getItem(a.key)||"";return lt(u)},dt=a=>{(a.type==="localStorage"?localStorage:sessionStorage).removeItem(a.key)};function gt(a,o=0,{start:u=!0,middle:l=!0,once:m=!1}={}){let v=u,_=0,C,y=!1;function t(...A){if(y)return;const w=Date.now()-_;_=Date.now(),u&&l&&w>=o&&(v=!0),v?(v=!1,a.apply(this,A),m&&t.cancel()):(l&&w<o||!l)&&(clearTimeout(C),C=setTimeout(()=>{_=Date.now(),a.apply(this,A),m&&t.cancel()},l?o-w:o))}return t.cancel=()=>{clearTimeout(C),y=!0},t}function ft(a,o=0,{start:u=!1,middle:l=!1,once:m=!1}={}){return gt(a,o,{start:u,middle:l,once:m})}var K={exports:{}};function vt(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var O={exports:{}};const mt={},yt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),wt=Z(yt);var Q;function bt(){return Q||(Q=1,function(a,o){(function(u,l){a.exports=l()})(j,function(){var u=u||function(l,m){var v;if(typeof window<"u"&&window.crypto&&(v=window.crypto),typeof self<"u"&&self.crypto&&(v=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(v=globalThis.crypto),!v&&typeof window<"u"&&window.msCrypto&&(v=window.msCrypto),!v&&typeof j<"u"&&j.crypto&&(v=j.crypto),!v&&typeof vt=="function")try{v=wt}catch{}var _=function(){if(v){if(typeof v.getRandomValues=="function")try{return v.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof v.randomBytes=="function")try{return v.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function e(){}return function(c){var h;return e.prototype=c,h=new e,e.prototype=null,h}}(),y={},t=y.lib={},A=t.Base=function(){return{extend:function(e){var c=C(this);return e&&c.mixIn(e),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var c in e)e.hasOwnProperty(c)&&(this[c]=e[c]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),w=t.WordArray=A.extend({init:function(e,c){e=this.words=e||[],c!=m?this.sigBytes=c:this.sigBytes=e.length*4},toString:function(e){return(e||E).stringify(this)},concat:function(e){var c=this.words,h=e.words,p=this.sigBytes,f=e.sigBytes;if(this.clamp(),p%4)for(var b=0;b<f;b++){var L=h[b>>>2]>>>24-b%4*8&255;c[p+b>>>2]|=L<<24-(p+b)%4*8}else for(var B=0;B<f;B+=4)c[p+B>>>2]=h[B>>>2];return this.sigBytes+=f,this},clamp:function(){var e=this.words,c=this.sigBytes;e[c>>>2]&=4294967295<<32-c%4*8,e.length=l.ceil(c/4)},clone:function(){var e=A.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var c=[],h=0;h<e;h+=4)c.push(_());return new w.init(c,e)}}),x=y.enc={},E=x.Hex={stringify:function(e){for(var c=e.words,h=e.sigBytes,p=[],f=0;f<h;f++){var b=c[f>>>2]>>>24-f%4*8&255;p.push((b>>>4).toString(16)),p.push((b&15).toString(16))}return p.join("")},parse:function(e){for(var c=e.length,h=[],p=0;p<c;p+=2)h[p>>>3]|=parseInt(e.substr(p,2),16)<<24-p%8*4;return new w.init(h,c/2)}},S=x.Latin1={stringify:function(e){for(var c=e.words,h=e.sigBytes,p=[],f=0;f<h;f++){var b=c[f>>>2]>>>24-f%4*8&255;p.push(String.fromCharCode(b))}return p.join("")},parse:function(e){for(var c=e.length,h=[],p=0;p<c;p++)h[p>>>2]|=(e.charCodeAt(p)&255)<<24-p%4*8;return new w.init(h,c)}},d=x.Utf8={stringify:function(e){try{return decodeURIComponent(escape(S.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return S.parse(unescape(encodeURIComponent(e)))}},g=t.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new w.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var c,h=this._data,p=h.words,f=h.sigBytes,b=this.blockSize,L=b*4,B=f/L;e?B=l.ceil(B):B=l.max((B|0)-this._minBufferSize,0);var z=B*b,W=l.min(z*4,f);if(z){for(var H=0;H<z;H+=b)this._doProcessBlock(p,H);c=p.splice(0,z),h.sigBytes-=W}return new w.init(c,W)},clone:function(){var e=A.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});t.Hasher=g.extend({cfg:A.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(e){return function(c,h){return new e.init(h).finalize(c)}},_createHmacHelper:function(e){return function(c,h){return new k.HMAC.init(e,h).finalize(c)}}});var k=y.algo={};return y}(Math);return u})}(O)),O.exports}(function(a,o){(function(u,l){a.exports=l(bt())})(j,function(u){return function(l){var m=u,v=m.lib,_=v.WordArray,C=v.Hasher,y=m.algo,t=[];(function(){for(var d=0;d<64;d++)t[d]=l.abs(l.sin(d+1))*4294967296|0})();var A=y.MD5=C.extend({_doReset:function(){this._hash=new _.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,g){for(var k=0;k<16;k++){var e=g+k,c=d[e];d[e]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}var h=this._hash.words,p=d[g+0],f=d[g+1],b=d[g+2],L=d[g+3],B=d[g+4],z=d[g+5],W=d[g+6],H=d[g+7],q=d[g+8],I=d[g+9],D=d[g+10],$=d[g+11],T=d[g+12],F=d[g+13],M=d[g+14],R=d[g+15],s=h[0],n=h[1],i=h[2],r=h[3];s=w(s,n,i,r,p,7,t[0]),r=w(r,s,n,i,f,12,t[1]),i=w(i,r,s,n,b,17,t[2]),n=w(n,i,r,s,L,22,t[3]),s=w(s,n,i,r,B,7,t[4]),r=w(r,s,n,i,z,12,t[5]),i=w(i,r,s,n,W,17,t[6]),n=w(n,i,r,s,H,22,t[7]),s=w(s,n,i,r,q,7,t[8]),r=w(r,s,n,i,I,12,t[9]),i=w(i,r,s,n,D,17,t[10]),n=w(n,i,r,s,$,22,t[11]),s=w(s,n,i,r,T,7,t[12]),r=w(r,s,n,i,F,12,t[13]),i=w(i,r,s,n,M,17,t[14]),n=w(n,i,r,s,R,22,t[15]),s=x(s,n,i,r,f,5,t[16]),r=x(r,s,n,i,W,9,t[17]),i=x(i,r,s,n,$,14,t[18]),n=x(n,i,r,s,p,20,t[19]),s=x(s,n,i,r,z,5,t[20]),r=x(r,s,n,i,D,9,t[21]),i=x(i,r,s,n,R,14,t[22]),n=x(n,i,r,s,B,20,t[23]),s=x(s,n,i,r,I,5,t[24]),r=x(r,s,n,i,M,9,t[25]),i=x(i,r,s,n,L,14,t[26]),n=x(n,i,r,s,q,20,t[27]),s=x(s,n,i,r,F,5,t[28]),r=x(r,s,n,i,b,9,t[29]),i=x(i,r,s,n,H,14,t[30]),n=x(n,i,r,s,T,20,t[31]),s=E(s,n,i,r,z,4,t[32]),r=E(r,s,n,i,q,11,t[33]),i=E(i,r,s,n,$,16,t[34]),n=E(n,i,r,s,M,23,t[35]),s=E(s,n,i,r,f,4,t[36]),r=E(r,s,n,i,B,11,t[37]),i=E(i,r,s,n,H,16,t[38]),n=E(n,i,r,s,D,23,t[39]),s=E(s,n,i,r,F,4,t[40]),r=E(r,s,n,i,p,11,t[41]),i=E(i,r,s,n,L,16,t[42]),n=E(n,i,r,s,W,23,t[43]),s=E(s,n,i,r,I,4,t[44]),r=E(r,s,n,i,T,11,t[45]),i=E(i,r,s,n,R,16,t[46]),n=E(n,i,r,s,b,23,t[47]),s=S(s,n,i,r,p,6,t[48]),r=S(r,s,n,i,H,10,t[49]),i=S(i,r,s,n,M,15,t[50]),n=S(n,i,r,s,z,21,t[51]),s=S(s,n,i,r,T,6,t[52]),r=S(r,s,n,i,L,10,t[53]),i=S(i,r,s,n,D,15,t[54]),n=S(n,i,r,s,f,21,t[55]),s=S(s,n,i,r,q,6,t[56]),r=S(r,s,n,i,R,10,t[57]),i=S(i,r,s,n,W,15,t[58]),n=S(n,i,r,s,F,21,t[59]),s=S(s,n,i,r,B,6,t[60]),r=S(r,s,n,i,$,10,t[61]),i=S(i,r,s,n,b,15,t[62]),n=S(n,i,r,s,I,21,t[63]),h[0]=h[0]+s|0,h[1]=h[1]+n|0,h[2]=h[2]+i|0,h[3]=h[3]+r|0},_doFinalize:function(){var d=this._data,g=d.words,k=this._nDataBytes*8,e=d.sigBytes*8;g[e>>>5]|=128<<24-e%32;var c=l.floor(k/4294967296),h=k;g[(e+64>>>9<<4)+15]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,g[(e+64>>>9<<4)+14]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,d.sigBytes=(g.length+1)*4,this._process();for(var p=this._hash,f=p.words,b=0;b<4;b++){var L=f[b];f[b]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return p},clone:function(){var d=C.clone.call(this);return d._hash=this._hash.clone(),d}});function w(d,g,k,e,c,h,p){var f=d+(g&k|~g&e)+c+p;return(f<<h|f>>>32-h)+g}function x(d,g,k,e,c,h,p){var f=d+(g&e|k&~e)+c+p;return(f<<h|f>>>32-h)+g}function E(d,g,k,e,c,h,p){var f=d+(g^k^e)+c+p;return(f<<h|f>>>32-h)+g}function S(d,g,k,e,c,h,p){var f=d+(k^(g|~e))+c+p;return(f<<h|f>>>32-h)+g}m.MD5=C._createHelper(A),m.HmacMD5=C._createHmacHelper(A)}(Math),u.MD5})})(K);var _t=K.exports;const xt=tt(_t),X=["9y16cxzg","sr2z1z63","hk2ssit3","acsevi4u","nu38i9ej","6m70kgre","hl8rvmhu","30uzkxp0","v9jggair","4ryav515","pgx6isvq","6b3zumy7","bxureygp","jff4xbhb","7j56lyfw","2tctuvza","8jfrswdr","r2as467y","jzye6ls1","bpi7fhat","ywp0p3qn","rzybga6p","84u199q5","kktjaqis","amn5oud8","a0zs4b52","x16y3u37","xku2lp9m","n8eawc7q","gw68xkfw","4wxtunev","ew2x6rzg","go9f3t54","7d0fkx5i","ai6ol58k","47jsslmm","70mxfzcz","b90wzl0c","ua78bvmr","7p60hdt4","ge5lw4u8","ref3rey2","wgay7vhx","b8l2u4mj","rk80y5ot","o37o4wq3","0moweoh0","r10m9bpy","wjilkjhj","il27pnod"],St=ht(X,5),Et="v2.0",Y=31,Ct=()=>Et,G=a=>{const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:a},()=>o.charAt(Math.floor(Math.random()*o.length))).join("")},kt=a=>{const o=At(a)%X.length,u=Math.floor(o/5);return St[u][o%5]},Bt=a=>xt(a).toString(),At=a=>{const o=Y+(a===null?0:Lt(a))|0;return Math.abs(o)},Lt=a=>{let o=1;for(let u=0;u<a.length;u++)o=Y*o+a.charCodeAt(u)|0;return o},zt=a=>{const o={f:G(5),g:G(3),r:"/company/getCompanyName",searchKey:a,t:Math.floor(Date.now()/1e3),v:Ct()},u=ut(o),l=kt(o.r.toUpperCase()+u),m=Bt(`GET${u}${l}`);return`https://c.qcc.com/embed/api${o.r}?${u}&m=${m}`},Ht=async a=>{if(a.length<2||a.length>100)return[];const o=zt(a),l=await(await fetch(o,{method:"GET",mode:"cors",headers:{Referer:"https://c.qcc.com/"}})).json(),m=[];return l.status!=="200"?m:l.result.map(v=>{const _=v.keyNo||N(v.companyName);return{name:v.companyName,id:_}})},Wt=async a=>{if(a.length<2||a.length>=100)return[];const o=`https://autocomplete.clearbit.com/v1/companies/suggest?query=${a}`;return(await(await fetch(o,{method:"GET",mode:"cors"})).json()).map(m=>({name:m.name,id:m.domain,avatar:m.logo}))},jt=async(a,o)=>{switch(o.api){case"qcc_open":return await Ht(a);case"clearbit":return await Wt(a);default:return[]}},qt=(a,o)=>{let u=!1;document.addEventListener("click",l=>{!a.contains(l.target)&&!u&&o(),u=a.contains(l.target)},!0)},It=["https://image.qcc.com/logo/{id}.jpg","https://image.qcc.com/auto/{id}.jpg"],Dt=async(a,o)=>{const u=a.dataset.id||"";if(o.avatarUrl){a.src=await P(u,[o.avatarUrl]);return}switch(o.api){case"qcc_open":a.src=await P(u,It);break}};class Tt{constructor(o={}){this.suggestions=[],this.suggestionElement=document.createElement("div"),this.suggestionActivatedClassName="suggestion-popper--activated",this.inputWrapElement=document.createElement("div"),this.inputWrapHaveWordsClassName="company-autocomplete--words",this.inputWrapActivatedClassName="company-autocomplete--activated",this.options=Object.assign({},ot,o),at(this.options.target)?this.target=document.querySelector(this.options.target):this.target=this.options.target,this.render()}render(){var l,m,v,_,C;if(!this.target)return;const o=[`<div class="company-autocomplete ${this.options.showSubmitButton?"company-autocomplete--show-submit":""}">`,'<div class="company-autocomplete__input">',`<input type="text" placeholder="${this.options.placeholder}" />`,this.options.clearable?`<div class="company-autocomplete__clear"><i class="company-autocomplete__clear-icon">${this.options.clearIcon}</i></div>`:"","</div>",this.options.showSubmitButton?'<div class="company-autocomplete__submit">':"",this.options.showSubmitButton?`<button type="button">${this.options.submitButtonLabel}</button>`:"",this.options.showSubmitButton?"</div>":"","</div>"];this.target.innerHTML=o.join(""),this.suggestionElement.classList.add("suggestion-popper"),this.clearSuggestion(),this.options.popupAppendToBody?document.body.appendChild(this.suggestionElement):this.target.appendChild(this.suggestionElement),this.inputWrapElement=this.target.querySelector(".company-autocomplete"),this.inputElement=this.inputWrapElement.querySelector("input");const u=this.inputWrapElement.querySelector("button");et(this.inputWrapElement,this.suggestionElement,()=>{st(this.inputWrapElement,this.suggestionElement,{middleware:[nt(this.options.offsetTop),it({apply:({rects:y})=>{Object.assign(this.suggestionElement.style,{width:`${y.reference.width}px`})}}),...this.options.autoFlip?[rt({fallbackPlacements:["top"]})]:[]]}).then(({x:y,y:t})=>{Object.assign(this.suggestionElement.style,{left:`${y}px`,top:`${t}px`})})}),(l=this.inputElement)==null||l.addEventListener("input",()=>{var t;this.keyboardActiveIndex=void 0,this.selectCompany=void 0;const y=((t=this.inputElement)==null?void 0:t.value)||"";this.inputWrapElement.classList[y.length>0?"add":"remove"](this.inputWrapHaveWordsClassName),y.length===0&&(this.clearSuggestion(),this.hideSuggestion())}),(m=this.inputElement)==null||m.addEventListener("input",ft(()=>{var t;const y=((t=this.inputElement)==null?void 0:t.value)||"";y&&this.handleQuerySuggestion(y)},this.options.queryDelay)),(v=this.inputElement)==null||v.addEventListener("click",y=>{if(this.suggestions.length>0){this.showSuggestion();return}const t=y.target.value;t?this.handleQuerySuggestion(t):this.options.history.enabled&&this.handleSuggestionDom(J(this.options.history),"history")}),u==null||u.addEventListener("click",()=>{var y;this.handleSubmit(((y=this.inputElement)==null?void 0:y.value)||"")}),qt(this.suggestionElement,()=>{this.hideSuggestion()}),this.suggestionElement.addEventListener("click",y=>{if(y.target.closest(".suggestion")){const t=y.target.closest(".suggestion"),A=(t==null?void 0:t.dataset.name)||"";this.inputElement.value=A,this.suggestions=[],this.selectCompany={id:(t==null?void 0:t.dataset.id)||"",name:A},this.handleSelect(),this.hideSuggestion(),this.inputWrapElement.classList.add(this.inputWrapHaveWordsClassName)}y.target.id==="remove-history-link"&&(dt(this.options.history),this.clearSuggestion(),this.hideSuggestion())}),this.inputClearElement=this.inputWrapElement.querySelector(".company-autocomplete__clear-icon"),this.inputClearElement&&((_=this.inputClearElement)==null||_.addEventListener("click",()=>{this.handleClear()})),this.options.autoFocus&&((C=this.inputElement)==null||C.focus()),this.inputElement.addEventListener("focus",()=>{U(this.options.onFocus)&&this.options.onFocus()}),this.inputElement.addEventListener("blur",()=>{U(this.options.onBlur)&&this.options.onBlur()})}handleQuerySuggestion(o){jt(o,this.options).then(u=>{this.handleSuggestionDom(u),this.options.onFetch()})}handleSuggestionDom(o,u="fetch"){var m,v;if(this.suggestions=o,o.length===0){this.clearSuggestion(),this.hideSuggestion();return}const l=['<div class="suggestion-popper__body">'];o.forEach(_=>{var y;const C=N(_.name);l.push(`<div class="suggestion" data-id="${_.id}" data-name="${C}">`),_.avatar?l.push(`<div class="suggestion__avatar"><img data-id="${_.id||""}" alt="${C}" src="${_.avatar||""}"/></div>`):u==="history"&&l.push(`<div class="suggestion__avatar"><i class="suggestion__avatar-icon">${(y=this.options.history)==null?void 0:y.itemIcon}</i></div>`),l.push(`<div class="suggestion__label">${_.name}</div>`),l.push('<div class="suggestion__extra"></div>'),l.push("</div>")}),l.push("</div>"),l.push('<div class="suggestion-popper__footer">'),u==="history"&&((m=this.options.history)!=null&&m.showClear)&&o.length>0&&l.push(`<a id="remove-history-link" href="javascript:;"><i class="suggestion-popper__icon">${((v=this.options.history)==null?void 0:v.clearIcon)||""}</i>删除历史</a>`),l.push("</div>"),this.suggestionElement.innerHTML=l.join(""),this.suggestionElement.querySelectorAll("img").forEach(_=>{_.getAttribute("src")||Dt(_,this.options)}),this.showSuggestion()}handleSelect(){this.options.history.enabled&&this.selectCompany&&pt(this.selectCompany,this.options.history),this.options.onSelect(this.selectCompany)}handleSubmit(o){this.options.submitCallback({company:this.selectCompany,text:o})}showSuggestion(){this.inputWrapElement.classList.add(this.inputWrapActivatedClassName),this.suggestionElement.classList.add(this.suggestionActivatedClassName),this.keyDownHandler&&this.inputWrapElement.removeEventListener("keydown",this.keyDownHandler),this.keyDownHandler=this.handleKeyDown.bind(this),this.inputWrapElement.addEventListener("keydown",this.keyDownHandler),this.options.onDropdownVisibleChange(!0)}hideSuggestion(){this.inputWrapElement.classList.remove(this.inputWrapActivatedClassName),this.suggestionElement.classList.remove(this.suggestionActivatedClassName),this.inputWrapElement.removeEventListener("keydown",this.keyDownHandler),this.options.onDropdownVisibleChange(!1)}clearSuggestion(){this.suggestionElement.textContent="",this.suggestions=[]}handleKeyDown(o){var u;switch(o.key){case"Enter":this.handleSubmit((u=o.target)==null?void 0:u.value);break;case"ArrowUp":this.keyboardActiveIndex?this.keyboardActiveIndex--:this.keyboardActiveIndex=this.suggestions.length-1,this.selectCompany=this.suggestions[this.keyboardActiveIndex],V(Array.from(this.suggestionElement.querySelectorAll(".suggestion")),this.keyboardActiveIndex,"suggestion--keyboard-active"),this.handleBackFill();break;case"ArrowDown":this.keyboardActiveIndex===void 0||this.keyboardActiveIndex>=this.suggestions.length-1?this.keyboardActiveIndex=0:this.keyboardActiveIndex++,this.selectCompany=this.suggestions[this.keyboardActiveIndex],V(Array.from(this.suggestionElement.querySelectorAll(".suggestion")),this.keyboardActiveIndex,"suggestion--keyboard-active"),this.handleBackFill();break;case"Escape":this.handleClear();break}}handleBackFill(){var o;this.options.backFill&&(this.inputElement.value=N(((o=this.selectCompany)==null?void 0:o.name)||""))}handleClear(){this.selectCompany=void 0,this.inputElement.value="",this.clearSuggestion(),this.inputWrapElement.classList.remove(this.inputWrapHaveWordsClassName),this.options.onClear()}}export{Tt as C};
