import{g as Z,c as j,a as tt,b as et,d as st,o as nt,s as it,f as rt}from"./floating-ui.dom.27ff446d.js";const ot={target:"body",api:"qcc_open",queryDelay:500,placeholder:"请输入企业名称或统一社会信用代码",clearable:!0,backFill:!1,popupAppendToBody:!0,clearIcon:'<svg viewBox="64 64 896 896" focusable="false" data-icon="close-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"></path></svg>',autoFocus:!0,history:{enabled:!0,type:"localStorage",key:"company-history",showClear:!0,itemIcon:'<svg viewBox="64 64 896 896" focusable="false" data-icon="history" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"></path></svg>',clearIcon:'<svg viewBox="64 64 896 896" focusable="false" data-icon="delete" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path></svg>'},onFetch:()=>{},onSelect:()=>{},onClear:()=>{},onFocus:()=>{},onBlur:()=>{},onDropdownVisibleChange:()=>{},showSubmitButton:!0,submitButtonLabel:"Submit",offsetTop:5,autoFlip:!1,submitCallback:()=>{}},at=a=>typeof a=="string",P=a=>typeof a=="function",M=async(a,o)=>{for(const h of o)try{const u=ct(h,"{id}",a),m=await fetch(u);if(m.status===200){const v=await m.blob();return URL.createObjectURL(v)}}catch(u){console.error(u)}return""},ct=(a,o,h)=>a.replace(new RegExp(o,"g"),h),V=(a,o,h)=>{a.forEach(u=>{u.classList.remove(h)}),a[o].classList.add(h)},U=a=>a.replace(/(<([^>]+)>)/gi,""),lt=a=>{try{const o=JSON.parse(a);return Array.isArray(o)?o:[]}catch{return[]}},ut=(a,o="")=>o+Object.keys(a).map(h=>`${h}=${a[h]}`).join("&"),ht=(a,o)=>{if(!o.enabled||!o.key)return;const h=o.type==="localStorage"?localStorage:sessionStorage,u=K(o),m=u.findIndex(v=>v.id===a.id);m>-1&&u.splice(m,1),u.splice(0,0,a),h.setItem(o.key,JSON.stringify(u.length>5?u.slice(0,5):u))},K=a=>{if(!a.enabled||!a.key)return[];const h=(a.type==="localStorage"?localStorage:sessionStorage).getItem(a.key)||"";return lt(h)},pt=a=>{(a.type==="localStorage"?localStorage:sessionStorage).removeItem(a.key)};function dt(a,o=0,{start:h=!0,middle:u=!0,once:m=!1}={}){let v=h,x=0,S,y=!1;function t(...A){if(y)return;const b=Date.now()-x;x=Date.now(),h&&u&&b>=o&&(v=!0),v?(v=!1,a.apply(this,A),m&&t.cancel()):(u&&b<o||!u)&&(clearTimeout(S),S=setTimeout(()=>{x=Date.now(),a.apply(this,A),m&&t.cancel()},u?o-b:o))}return t.cancel=()=>{clearTimeout(S),y=!0},t}function gt(a,o=0,{start:h=!1,middle:u=!1,once:m=!1}={}){return dt(a,o,{start:h,middle:u,once:m})}var X={exports:{}};function ft(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var N={exports:{}};const vt={},mt=Object.freeze(Object.defineProperty({__proto__:null,default:vt},Symbol.toStringTag,{value:"Module"})),yt=Z(mt);var Q;function bt(){return Q||(Q=1,function(a,o){(function(h,u){a.exports=u()})(j,function(){var h=h||function(u,m){var v;if(typeof window<"u"&&window.crypto&&(v=window.crypto),typeof self<"u"&&self.crypto&&(v=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(v=globalThis.crypto),!v&&typeof window<"u"&&window.msCrypto&&(v=window.msCrypto),!v&&typeof j<"u"&&j.crypto&&(v=j.crypto),!v&&typeof ft=="function")try{v=yt}catch{}var x=function(){if(v){if(typeof v.getRandomValues=="function")try{return v.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof v.randomBytes=="function")try{return v.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},S=Object.create||function(){function e(){}return function(c){var l;return e.prototype=c,l=new e,e.prototype=null,l}}(),y={},t=y.lib={},A=t.Base=function(){return{extend:function(e){var c=S(this);return e&&c.mixIn(e),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var c in e)e.hasOwnProperty(c)&&(this[c]=e[c]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=t.WordArray=A.extend({init:function(e,c){e=this.words=e||[],c!=m?this.sigBytes=c:this.sigBytes=e.length*4},toString:function(e){return(e||C).stringify(this)},concat:function(e){var c=this.words,l=e.words,p=this.sigBytes,f=e.sigBytes;if(this.clamp(),p%4)for(var w=0;w<f;w++){var L=l[w>>>2]>>>24-w%4*8&255;c[p+w>>>2]|=L<<24-(p+w)%4*8}else for(var B=0;B<f;B+=4)c[p+B>>>2]=l[B>>>2];return this.sigBytes+=f,this},clamp:function(){var e=this.words,c=this.sigBytes;e[c>>>2]&=4294967295<<32-c%4*8,e.length=u.ceil(c/4)},clone:function(){var e=A.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var c=[],l=0;l<e;l+=4)c.push(x());return new b.init(c,e)}}),_=y.enc={},C=_.Hex={stringify:function(e){for(var c=e.words,l=e.sigBytes,p=[],f=0;f<l;f++){var w=c[f>>>2]>>>24-f%4*8&255;p.push((w>>>4).toString(16)),p.push((w&15).toString(16))}return p.join("")},parse:function(e){for(var c=e.length,l=[],p=0;p<c;p+=2)l[p>>>3]|=parseInt(e.substr(p,2),16)<<24-p%8*4;return new b.init(l,c/2)}},E=_.Latin1={stringify:function(e){for(var c=e.words,l=e.sigBytes,p=[],f=0;f<l;f++){var w=c[f>>>2]>>>24-f%4*8&255;p.push(String.fromCharCode(w))}return p.join("")},parse:function(e){for(var c=e.length,l=[],p=0;p<c;p++)l[p>>>2]|=(e.charCodeAt(p)&255)<<24-p%4*8;return new b.init(l,c)}},d=_.Utf8={stringify:function(e){try{return decodeURIComponent(escape(E.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return E.parse(unescape(encodeURIComponent(e)))}},g=t.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var c,l=this._data,p=l.words,f=l.sigBytes,w=this.blockSize,L=w*4,B=f/L;e?B=u.ceil(B):B=u.max((B|0)-this._minBufferSize,0);var q=B*w,W=u.min(q*4,f);if(q){for(var H=0;H<q;H+=w)this._doProcessBlock(p,H);c=p.splice(0,q),l.sigBytes-=W}return new b.init(c,W)},clone:function(){var e=A.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});t.Hasher=g.extend({cfg:A.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(e){return function(c,l){return new e.init(l).finalize(c)}},_createHmacHelper:function(e){return function(c,l){return new k.HMAC.init(e,l).finalize(c)}}});var k=y.algo={};return y}(Math);return h})}(N)),N.exports}(function(a,o){(function(h,u){a.exports=u(bt())})(j,function(h){return function(u){var m=h,v=m.lib,x=v.WordArray,S=v.Hasher,y=m.algo,t=[];(function(){for(var d=0;d<64;d++)t[d]=u.abs(u.sin(d+1))*4294967296|0})();var A=y.MD5=S.extend({_doReset:function(){this._hash=new x.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,g){for(var k=0;k<16;k++){var e=g+k,c=d[e];d[e]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}var l=this._hash.words,p=d[g+0],f=d[g+1],w=d[g+2],L=d[g+3],B=d[g+4],q=d[g+5],W=d[g+6],H=d[g+7],I=d[g+8],D=d[g+9],z=d[g+10],$=d[g+11],T=d[g+12],F=d[g+13],R=d[g+14],O=d[g+15],s=l[0],n=l[1],i=l[2],r=l[3];s=b(s,n,i,r,p,7,t[0]),r=b(r,s,n,i,f,12,t[1]),i=b(i,r,s,n,w,17,t[2]),n=b(n,i,r,s,L,22,t[3]),s=b(s,n,i,r,B,7,t[4]),r=b(r,s,n,i,q,12,t[5]),i=b(i,r,s,n,W,17,t[6]),n=b(n,i,r,s,H,22,t[7]),s=b(s,n,i,r,I,7,t[8]),r=b(r,s,n,i,D,12,t[9]),i=b(i,r,s,n,z,17,t[10]),n=b(n,i,r,s,$,22,t[11]),s=b(s,n,i,r,T,7,t[12]),r=b(r,s,n,i,F,12,t[13]),i=b(i,r,s,n,R,17,t[14]),n=b(n,i,r,s,O,22,t[15]),s=_(s,n,i,r,f,5,t[16]),r=_(r,s,n,i,W,9,t[17]),i=_(i,r,s,n,$,14,t[18]),n=_(n,i,r,s,p,20,t[19]),s=_(s,n,i,r,q,5,t[20]),r=_(r,s,n,i,z,9,t[21]),i=_(i,r,s,n,O,14,t[22]),n=_(n,i,r,s,B,20,t[23]),s=_(s,n,i,r,D,5,t[24]),r=_(r,s,n,i,R,9,t[25]),i=_(i,r,s,n,L,14,t[26]),n=_(n,i,r,s,I,20,t[27]),s=_(s,n,i,r,F,5,t[28]),r=_(r,s,n,i,w,9,t[29]),i=_(i,r,s,n,H,14,t[30]),n=_(n,i,r,s,T,20,t[31]),s=C(s,n,i,r,q,4,t[32]),r=C(r,s,n,i,I,11,t[33]),i=C(i,r,s,n,$,16,t[34]),n=C(n,i,r,s,R,23,t[35]),s=C(s,n,i,r,f,4,t[36]),r=C(r,s,n,i,B,11,t[37]),i=C(i,r,s,n,H,16,t[38]),n=C(n,i,r,s,z,23,t[39]),s=C(s,n,i,r,F,4,t[40]),r=C(r,s,n,i,p,11,t[41]),i=C(i,r,s,n,L,16,t[42]),n=C(n,i,r,s,W,23,t[43]),s=C(s,n,i,r,D,4,t[44]),r=C(r,s,n,i,T,11,t[45]),i=C(i,r,s,n,O,16,t[46]),n=C(n,i,r,s,w,23,t[47]),s=E(s,n,i,r,p,6,t[48]),r=E(r,s,n,i,H,10,t[49]),i=E(i,r,s,n,R,15,t[50]),n=E(n,i,r,s,q,21,t[51]),s=E(s,n,i,r,T,6,t[52]),r=E(r,s,n,i,L,10,t[53]),i=E(i,r,s,n,z,15,t[54]),n=E(n,i,r,s,f,21,t[55]),s=E(s,n,i,r,I,6,t[56]),r=E(r,s,n,i,O,10,t[57]),i=E(i,r,s,n,W,15,t[58]),n=E(n,i,r,s,F,21,t[59]),s=E(s,n,i,r,B,6,t[60]),r=E(r,s,n,i,$,10,t[61]),i=E(i,r,s,n,w,15,t[62]),n=E(n,i,r,s,D,21,t[63]),l[0]=l[0]+s|0,l[1]=l[1]+n|0,l[2]=l[2]+i|0,l[3]=l[3]+r|0},_doFinalize:function(){var d=this._data,g=d.words,k=this._nDataBytes*8,e=d.sigBytes*8;g[e>>>5]|=128<<24-e%32;var c=u.floor(k/4294967296),l=k;g[(e+64>>>9<<4)+15]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,g[(e+64>>>9<<4)+14]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,d.sigBytes=(g.length+1)*4,this._process();for(var p=this._hash,f=p.words,w=0;w<4;w++){var L=f[w];f[w]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return p},clone:function(){var d=S.clone.call(this);return d._hash=this._hash.clone(),d}});function b(d,g,k,e,c,l,p){var f=d+(g&k|~g&e)+c+p;return(f<<l|f>>>32-l)+g}function _(d,g,k,e,c,l,p){var f=d+(g&e|k&~e)+c+p;return(f<<l|f>>>32-l)+g}function C(d,g,k,e,c,l,p){var f=d+(g^k^e)+c+p;return(f<<l|f>>>32-l)+g}function E(d,g,k,e,c,l,p){var f=d+(k^(g|~e))+c+p;return(f<<l|f>>>32-l)+g}m.MD5=S._createHelper(A),m.HmacMD5=S._createHmacHelper(A)}(Math),h.MD5})})(X);var wt=X.exports;const xt=tt(wt),G=["zzcscp7g","e6i8jtbl","eux6on67","h17dd8cq","b1ur65ky","ktzcn5bw","xtya6q26","g6fr429c","50kks7sc","r71x7c6u","odouivjk","rsi9vpqy","kj6rksdy","27w45dme","a769pvn7","ns84opu3","jdl9qs00","ogzjpunb","lo93uuin","yhlx8e4p","6t6kpahe","v122ogxz","46a0bnjx","eqnfjp7b","t4b7pon5","xhgb7dcl","ydhoswq0","gy4ubl0w","bgvxuf71","ityjfac8","lbati1a4","wo5j9npq","jor1dbu5","aha53e8e","ei3y8a8f","pbc3rtvb","sc1ghnvh","3ng27uhh","4hl15zxr","8fpxxpgy","cieadu1u","va7m26gv","h39vz873","nliabzs6","24xvriaf","tyobyhea","k4y0tp6d","rqwft3lw","y7g10qjh","5xpqdylr"],_t="v1.0",Y=31,St=()=>_t,J=a=>{const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:a},()=>o.charAt(Math.floor(Math.random()*o.length))).join("")},Et=a=>{const o=kt(a)%G.length;return G[o]},Ct=a=>xt(a).toString(),kt=a=>{const o=Y+(a===null?0:Bt(a))|0;return Math.abs(o)},Bt=a=>{let o=1;for(let h=0;h<a.length;h++)o=Y*o+a.charCodeAt(h)|0;return o},At=a=>{const o={f:J(5),g:J(3),r:"/company/getCompanyName",searchKey:a,t:Math.floor(Date.now()/1e3),v:St()},h=ut(o),u=Et(o.r.toUpperCase()+h),m=Ct(`GET${h}${u}`);return`https://c.qcc.com/embed/api${o.r}?${h}&m=${m}`},Lt=async a=>{if(a.length<2||a.length>100)return[];const o=At(a),u=await(await fetch(o,{method:"GET",mode:"cors",headers:{Referer:"https://c.qcc.com/"}})).json(),m=[];return u.status!=="200"?m:u.result.map(v=>{const x=v.keyNo||U(v.companyName);return{name:v.companyName,id:x}})},qt=async a=>{if(a.length<2||a.length>=100)return[];const o=`https://autocomplete.clearbit.com/v1/companies/suggest?query=${a}`;return(await(await fetch(o,{method:"GET",mode:"cors"})).json()).map(m=>({name:m.name,id:m.domain,avatar:m.logo}))},Ht=async(a,o)=>{switch(o.api){case"qcc_open":return await Lt(a);case"clearbit":return await qt(a);default:return[]}},Wt=(a,o)=>{let h=!1;document.addEventListener("click",u=>{!a.contains(u.target)&&!h&&o(),h=a.contains(u.target)},!0)},jt=["https://image.qcc.com/logo/{id}.jpg","https://image.qcc.com/auto/{id}.jpg"],It=async(a,o)=>{const h=a.dataset.id||"";if(o.avatarUrl){a.src=await M(h,[o.avatarUrl]);return}switch(o.api){case"qcc_open":a.src=await M(h,jt);break}};class zt{constructor(o={}){this.suggestions=[],this.suggestionElement=document.createElement("div"),this.suggestionActivatedClassName="suggestion-popper--activated",this.inputWrapElement=document.createElement("div"),this.inputWrapHaveWordsClassName="company-autocomplete--words",this.inputWrapActivatedClassName="company-autocomplete--activated",this.options=Object.assign({},ot,o),at(this.options.target)?this.target=document.querySelector(this.options.target):this.target=this.options.target,this.render()}render(){var u,m,v,x,S;if(!this.target)return;const o=[`<div class="company-autocomplete ${this.options.showSubmitButton?"company-autocomplete--show-submit":""}">`,'<div class="company-autocomplete__input">',`<input type="text" placeholder="${this.options.placeholder}" />`,this.options.clearable?`<div class="company-autocomplete__clear">${this.options.clearIcon}</div>`:"","</div>",this.options.showSubmitButton?'<div class="company-autocomplete__submit">':"",this.options.showSubmitButton?`<button type="button">${this.options.submitButtonLabel}</button>`:"",this.options.showSubmitButton?"</div>":"","</div>"];this.target.innerHTML=o.join(""),this.suggestionElement.classList.add("suggestion-popper"),this.clearSuggestion(),this.options.popupAppendToBody?document.body.appendChild(this.suggestionElement):this.target.appendChild(this.suggestionElement),this.inputWrapElement=this.target.querySelector(".company-autocomplete"),this.inputElement=this.inputWrapElement.querySelector("input");const h=this.inputWrapElement.querySelector("button");et(this.inputWrapElement,this.suggestionElement,()=>{st(this.inputWrapElement,this.suggestionElement,{middleware:[nt(this.options.offsetTop),it({apply:({rects:y})=>{Object.assign(this.suggestionElement.style,{width:`${y.reference.width}px`})}}),...this.options.autoFlip?[rt({fallbackPlacements:["top"]})]:[]]}).then(({x:y,y:t})=>{Object.assign(this.suggestionElement.style,{left:`${y}px`,top:`${t}px`})})}),(u=this.inputElement)==null||u.addEventListener("input",()=>{var t;this.keyboardActiveIndex=void 0,this.selectCompany=void 0;const y=((t=this.inputElement)==null?void 0:t.value)||"";this.inputWrapElement.classList[y.length>0?"add":"remove"](this.inputWrapHaveWordsClassName),y.length===0&&(this.clearSuggestion(),this.hideSuggestion())}),(m=this.inputElement)==null||m.addEventListener("input",gt(()=>{var t;const y=((t=this.inputElement)==null?void 0:t.value)||"";y&&this.handleQuerySuggestion(y)},this.options.queryDelay)),(v=this.inputElement)==null||v.addEventListener("click",y=>{if(this.suggestions.length>0){this.showSuggestion();return}const t=y.target.value;t?this.handleQuerySuggestion(t):this.options.history.enabled&&this.handleSuggestionDom(K(this.options.history),"history")}),h==null||h.addEventListener("click",()=>{var y;this.handleSubmit(((y=this.inputElement)==null?void 0:y.value)||"")}),Wt(this.suggestionElement,()=>{this.hideSuggestion()}),this.suggestionElement.addEventListener("click",y=>{if(y.target.closest(".suggestion")){const t=y.target.closest(".suggestion"),A=(t==null?void 0:t.dataset.name)||"";this.inputElement.value=A,this.suggestions=[],this.selectCompany={id:(t==null?void 0:t.dataset.id)||"",name:A},this.handleSelect(),this.hideSuggestion(),this.inputWrapElement.classList.add(this.inputWrapHaveWordsClassName)}y.target.id==="remove-history-link"&&(pt(this.options.history),this.clearSuggestion(),this.hideSuggestion())}),this.inputClearElement=this.inputWrapElement.querySelector(".company-autocomplete__clear"),this.inputClearElement&&((x=this.inputClearElement)==null||x.addEventListener("click",()=>{this.handleClear()})),this.options.autoFocus&&((S=this.inputElement)==null||S.focus()),this.inputElement.addEventListener("focus",()=>{P(this.options.onFocus)&&this.options.onFocus()}),this.inputElement.addEventListener("blur",()=>{P(this.options.onBlur)&&this.options.onBlur()})}handleQuerySuggestion(o){Ht(o,this.options).then(h=>{this.handleSuggestionDom(h),this.options.onFetch()})}handleSuggestionDom(o,h="fetch"){var m,v;if(this.suggestions=o,o.length===0){this.clearSuggestion(),this.hideSuggestion();return}const u=['<div class="suggestion-popper__body">'];o.forEach(x=>{const S=U(x.name);u.push(`<div class="suggestion" data-id="${x.id}" data-name="${S}">`),x.avatar&&u.push(`<div class="suggestion__avatar"><img data-id="${x.id||""}" alt="${S}" src="${x.avatar||""}"/></div>`),u.push(`<div class="suggestion__label">${x.name}</div>`),u.push('<div class="suggestion__extra"></div>'),u.push("</div>")}),u.push("</div>"),u.push('<div class="suggestion-popper__footer">'),h==="history"&&((m=this.options.history)!=null&&m.showClear)&&o.length>0&&u.push(`<a id="remove-history-link" href="javascript:;">${((v=this.options.history)==null?void 0:v.clearIcon)||""}删除历史</a>`),u.push("</div>"),this.suggestionElement.innerHTML=u.join(""),this.suggestionElement.querySelectorAll("img").forEach(x=>{var S;if(h==="history"){x.outerHTML=(S=this.options.history)==null?void 0:S.itemIcon;return}x.getAttribute("src")||It(x,this.options)}),this.showSuggestion()}handleSelect(){this.options.history.enabled&&this.selectCompany&&ht(this.selectCompany,this.options.history),this.options.onSelect(this.selectCompany)}handleSubmit(o){this.options.submitCallback({company:this.selectCompany,text:o})}showSuggestion(){this.inputWrapElement.classList.add(this.inputWrapActivatedClassName),this.suggestionElement.classList.add(this.suggestionActivatedClassName),this.keyDownHandler&&this.inputWrapElement.removeEventListener("keydown",this.keyDownHandler),this.keyDownHandler=this.handleKeyDown.bind(this),this.inputWrapElement.addEventListener("keydown",this.keyDownHandler),this.options.onDropdownVisibleChange(!0)}hideSuggestion(){this.inputWrapElement.classList.remove(this.inputWrapActivatedClassName),this.suggestionElement.classList.remove(this.suggestionActivatedClassName),this.inputWrapElement.removeEventListener("keydown",this.keyDownHandler),this.options.onDropdownVisibleChange(!1)}clearSuggestion(){this.suggestionElement.textContent="",this.suggestions=[]}handleKeyDown(o){var h;switch(o.key){case"Enter":this.handleSubmit((h=o.target)==null?void 0:h.value);break;case"ArrowUp":this.keyboardActiveIndex?this.keyboardActiveIndex--:this.keyboardActiveIndex=this.suggestions.length-1,this.selectCompany=this.suggestions[this.keyboardActiveIndex],V(Array.from(this.suggestionElement.querySelectorAll(".suggestion")),this.keyboardActiveIndex,"suggestion--keyboard-active"),this.handleBackFill();break;case"ArrowDown":this.keyboardActiveIndex===void 0||this.keyboardActiveIndex>=this.suggestions.length-1?this.keyboardActiveIndex=0:this.keyboardActiveIndex++,this.selectCompany=this.suggestions[this.keyboardActiveIndex],V(Array.from(this.suggestionElement.querySelectorAll(".suggestion")),this.keyboardActiveIndex,"suggestion--keyboard-active"),this.handleBackFill();break;case"Escape":this.handleClear();break}}handleBackFill(){var o;this.options.backFill&&(this.inputElement.value=U(((o=this.selectCompany)==null?void 0:o.name)||""))}handleClear(){this.selectCompany=void 0,this.inputElement.value="",this.clearSuggestion(),this.inputWrapElement.classList.remove(this.inputWrapHaveWordsClassName),this.options.onClear()}}export{zt as C};
